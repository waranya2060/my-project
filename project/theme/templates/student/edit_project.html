{% extends 'base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto p-4">  <!-- ปรับ max-width เป็น max-w-2xl และลด padding เป็น p-4 -->
    <!-- Title -->
    <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">แก้ไขโครงงาน</h2>  <!-- ปรับขนาด font เป็น text-2xl -->
    
    <!-- Project Details -->
    {% if project %}
        <div class="bg-white p-4 rounded-lg shadow-md mb-6">  <!-- ลด padding เป็น p-4 -->
            <h3 class="text-xl font-semibold text-blue-600 mb-3">รายละเอียดโครงงาน</h3>  <!-- ปรับขนาด font เป็น text-xl -->

            <!-- Topic -->
            <p class="text-gray-700 mb-2">
                <i class="fas fa-book mr-2"></i> <strong>หัวข้อ:</strong> {{ project.topic }}
            </p>

            <!-- Year -->
            <p class="text-gray-700 mb-2">
                <i class="fas fa-calendar-alt mr-2"></i> <strong>ปี:</strong> {{ project.year }}
            </p>

            <!-- Advisor -->
            <p class="text-gray-700 mb-2">
                <i class="fas fa-user-tie mr-2"></i> <strong>อาจารย์ที่ปรึกษา:</strong> 
                {{ project.advisor.first_name }} {{ project.advisor.last_name }}
            </p>

            <!-- Committee Members -->
            <p class="text-gray-700 mb-3">  <!-- ลด margin-bottom เป็น mb-3 -->
                <i class="fas fa-users mr-2"></i> <strong>กรรมการ:</strong>
                {% for committee_member in project.committee.all %}
                    {{ committee_member.first_name }} {{ committee_member.last_name }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                    ไม่มีกรรมการ
                {% endfor %}
            </p>

            <!-- Uploaded Files -->
            <div class="mb-3">  <!-- ลด margin-bottom เป็น mb-3 -->
                <h4 class="text-base font-semibold text-gray-800 mb-1">  <!-- ปรับขนาด font เป็น text-base -->
                    <i class="fas fa-file-upload mr-2"></i> ไฟล์ที่อัปโหลด
                </h4>
                {% if project.files.all %}
                    <ul class="list-disc list-inside">
                        {% for file in project.files.all %}
                            <!-- แสดงไฟล์ที่อัปโหลด -->
                            {% if file.file %}
                                <li class="text-gray-700">
                                    <a href="{{ file.file.url }}" class="text-blue-500 hover:underline" target="_blank">
                                        <i class="fas fa-file mr-2"></i> {{ file.file.name }}
                                    </a>
                                    {% if file.uploaded_at %}
                                        <span class="text-xs text-gray-500">(อัปโหลดเมื่อ {{ file.uploaded_at|date:"d/m/Y H:i" }})</span>  <!-- ปรับขนาด font เป็น text-xs -->
                                    {% endif %}
                                </li>
                            {% endif %}

                            <!-- แสดงลิงก์ -->
                            {% if file.url %}
                                <li class="text-gray-700">
                                    <a href="{{ file.url }}" class="text-blue-500 hover:underline" target="_blank">
                                        <i class="fas fa-link mr-2"></i> {{ file.url }}
                                    </a>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-gray-500 text-sm">ไม่มีไฟล์ที่อัปโหลด</p>  <!-- ปรับขนาด font เป็น text-sm -->
                {% endif %}
            </div>
        </div>

        <!-- Edit Form -->
        <div class="bg-white p-4 rounded-lg shadow-md">  <!-- ลด padding เป็น p-4 -->
            <h3 class="text-xl font-semibold text-blue-600 mb-3">แก้ไขข้อมูลโครงงาน</h3>  <!-- ปรับขนาด font เป็น text-xl -->

            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Project Form Fields -->
                <div class="mb-4">  <!-- ลด margin-bottom เป็น mb-4 -->
                    <label for="id_topic" class="block text-sm font-medium text-gray-700 mb-1">  <!-- ลด margin-bottom เป็น mb-1 -->
                        <i class="fas fa-book mr-2"></i> หัวข้อโครงงาน
                    </label>
                    {{ project_form.topic }}
                </div>

                <div class="mb-4">  <!-- ลด margin-bottom เป็น mb-4 -->
                    <label for="id_year" class="block text-sm font-medium text-gray-700 mb-1">  <!-- ลด margin-bottom เป็น mb-1 -->
                        <i class="fas fa-calendar-alt mr-2"></i> ปี
                    </label>
                    {{ project_form.year }}
                </div>

                <div class="mb-4">  <!-- ลด margin-bottom เป็น mb-4 -->
                    <label for="id_advisor" class="block text-sm font-medium text-gray-700 mb-1">  <!-- ลด margin-bottom เป็น mb-1 -->
                        <i class="fas fa-user-tie mr-2"></i> อาจารย์ที่ปรึกษา
                    </label>
                    {{ project_form.advisor }}
                </div>

                <!-- File Upload Section -->
                <div class="mb-4">  <!-- ลด margin-bottom เป็น mb-4 -->
                    <label for="id_file" class="block text-sm font-medium text-gray-700 mb-1">  <!-- ลด margin-bottom เป็น mb-1 -->
                        <i class="fas fa-file-upload mr-2"></i> อัปโหลดไฟล์
                    </label>
                    {{ file_form.file }}
                </div>

                <div class="mb-4">  <!-- ลด margin-bottom เป็น mb-4 -->
                    <label for="id_url" class="block text-sm font-medium text-gray-700 mb-1">  <!-- ลด margin-bottom เป็น mb-1 -->
                        <i class="fas fa-link mr-2"></i> ลิงก์ไฟล์
                    </label>
                    {{ file_form.url }}
                </div>

                <!-- Submit Button -->
                <div class="flex justify-center space-x-3">  <!-- ลด space-x เป็น space-x-3 -->
                    <!-- Save Changes Button -->
                    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center justify-center space-x-2">
                        <i class="fas fa-save mr-2"></i> บันทึกการเปลี่ยนแปลง
                    </button>

                    <!-- Back Button -->
                    <a href="{% url 'my_projects' %}" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition duration-300 flex items-center justify-center space-x-2">
                        <i class="fas fa-arrow-left mr-2"></i> ย้อนกลับ
                    </a>
                </div>
            </form>
        </div>
    {% else %}
        <!-- No Project Found -->
        <div class="text-center py-6">  <!-- ลด padding เป็น py-6 -->
            <i class="fas fa-exclamation-circle text-3xl text-gray-400 mb-3"></i>  <!-- ปรับขนาด icon เป็น text-3xl -->
            <p class="text-gray-700 text-lg">ไม่พบโครงงานที่คุณต้องการแก้ไข</p>  <!-- ปรับขนาด font เป็น text-lg -->
        </div>
    {% endif %}
</div>
{% endblock %}